<div class="event-list-page">
  <section class="page-header">
    <div class="container">
      <div class="header-content">
        <div class="header-text">
          <h1 class="page-title">Tất cả sự kiện</h1>
          <p class="page-subtitle">
            Khám phá hàng nghìn sự kiện thú vị đang chờ bạn.
          </p>
        </div>
        <div class="header-stats">
          <div class="stat-card">
            <i class="pi pi-ticket"></i>
            <div class="stat-info">
              <span class="stat-number">{{ totalElements }}</span>
              <span class="stat-label">Sự kiện</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="filters-section">
    <div class="container">
      <p-card styleClass="filters-card">
        <div class="filters-grid">
          <div class="search-container">
            <span class="p-input-icon-left">
              <i class="pi pi-search"></i>
              <input
                type="text"
                pInputText
                placeholder="Tìm kiếm tên sự kiện..."
                class="w-full"
                [(ngModel)]="searchTerm"
                (keydown)="onKeyDown($event)"
              />
            </span>
          </div>

          <p-select
            [options]="categories"
            [(ngModel)]="selectedCategory"
            (onChange)="onFilterChange()"
            optionLabel="label"
            optionValue="value"
            placeholder="Chọn danh mục"
            styleClass="category-select"
          >
          </p-select>

          <div class="sort-container">
            <p-select
              [options]="sortOptions"
              [(ngModel)]="selectedSort"
              (onChange)="onFilterChange()"
              optionLabel="label"
              optionValue="value"
              styleClass="sort-select"


            >
            </p-select>

            <p-select
              [options]="currentSortDirections"
              [(ngModel)]="selectedSortDirection"
              (onChange)="onFilterChange()"
              optionLabel="label"
              optionValue="value"
              styleClass="sort-direction-select"

            >
            </p-select>
          </div>
        </div>
      </p-card>
    </div>
  </section>

  <section class="events-section">
    <div class="container">
      @if (isLoading()){
      <div class="loading-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Đang tải danh sách sự kiện...</p>
      </div>
      }@else{
      <ng-container>
        <div *ngIf="events.length === 0" class="empty-state">

          <div class="empty-content">
            <div class="pi pi-search empty-icon"></div>

            <h2 class="empty-title">Không tìm thấy sự kiện</h2>
            <p class="empty-description">
              Rất tiếc, không có sự kiện nào phù hợp với tìm kiếm của bạn. Hãy
              thử lại với các bộ lọc khác.
            </p>
            <p-button
              label="Xóa bộ lọc"
              icon="pi pi-refresh"
              (click)="clearFilters()"
            ></p-button>
          </div>
        </div>

        <div *ngIf="events.length > 0">
          <div class="events-grid" [class.list-view]="currentView === 'list'">
            <app-event-card
              *ngFor="let event of events; trackBy: trackByEventId"
              [event]="event"
              (viewDetails)="bookEvent($event)"
            ></app-event-card>
          </div>

          <!-- <div
            *ngIf="!isLoading() && events.length > 0 && totalPages > 1"
            class="pagination-container"
          >
            <p-paginator
              [first]="currentPage * pageSize"
              [rows]="pageSize"
              [totalRecords]="totalElements"
              [showCurrentPageReport]="true"
              currentPageReportTemplate="Hiển thị {first} - {last} trong tổng số {totalRecords} sự kiện"
              [showPageLinks]="true"
              [showJumpToPageDropdown]="true"
              (onPageChange)="onPageChange($event)"
            >
            </p-paginator>
          </div> -->
          <app-events-pagination
            *ngIf="!isLoading() && events.length > 0"
            [currentPage]="currentPage+1"
            [totalPages]="totalPages"
            [totalElements]="totalElements"
            [pageSize]="pageSize"
            (pageChange)="onPageChange($event)"
          >
          </app-events-pagination>
        </div>
      </ng-container>
      }
    </div>
  </section>
</div>
